{% extends "core/base.html" %}
{% block title %}History - {{ model_name|capfirst }}{% endblock %}
{% block content %}
<h1 class="mb-4">History for {{ model_name|capfirst }} #{{ object.pk }}</h1>
<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>Date</th>
      <th>User</th>
      <th>Type</th>
      <th>Changes</th>
    </tr>
  </thead>
  <tbody>
    {% for h in history %}
    <tr>
      <td>{{ h.history_date }}</td>
      <td>{{ h.history_user|default:'-' }}</td>
      <td>{{ h.get_history_type_display }}</td>
      <td>
        {% if h.prev_record %}
          {% for field in h.diff_against(h.prev_record).changed_fields %}
            <strong>{{ field }}</strong>: {{ h.diff_against(h.prev_record).old_record.__dict__[field] }} â†’ {{ h.__dict__[field] }}<br>
          {% endfor %}
        {% else %}
          Created
        {% endif %}
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
<a href="javascript:history.back()" class="btn btn-secondary">Back</a>
{% endblock %} 